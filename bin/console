#!/usr/bin/env php
<?php

date_default_timezone_set('UTC');
set_time_limit(0);
@require_once __DIR__ . '/../vendor/autoload.php';
@require_once __DIR__ . '/../configs/global.php';

use Symfony\Component\Console\Application;
use Tlab\DI\Container;
use Tlab\Libraries\Database;

$services   = include _CONFIG_BASE_PATH._DS.'configs/services.php';
$parameters = include _CONFIG_BASE_PATH._DS.'configs/parameters.php';
$DIContainer = new Container($services, $parameters);
$dbInstance = $DIContainer->get(Database::class);

$filesList = glob(_CONFIG_BASE_PATH._DS.'app'._DS.'Tlab'._DS.'Command'._DS.'*Command.php');

$commandList = array();
foreach($filesList as $file){
	$command = 'Tlab\\Command\\'.basename($file,'.php');
	$commandList[] = new $command;	
}

$console = new Application('Pixel CLI Application', '0.1.0');

$console->addCommands($commandList);
$console->run();
